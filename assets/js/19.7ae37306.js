(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{272:function(n,s,a){"use strict";a.r(s);var e=a(0),i=Object(e.a)({},function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h2",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题","aria-hidden":"true"}},[n._v("#")]),n._v(" 问题")]),n._v(" "),a("p",[n._v("在electron的系统通知踩了坑，记录一下。")]),n._v(" "),a("h2",{attrs:{id:"前提"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前提","aria-hidden":"true"}},[n._v("#")]),n._v(" 前提")]),n._v(" "),a("p",[n._v("首先在pc端，想要electron自带的系统通知可以使用，要先注入appId。")]),n._v(" "),a("p",[n._v("否则程序不会报错，通知也不会生效。")]),n._v(" "),a("p",[n._v("在main.js中注入appId")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("import pkg from '../../package.json'\nconst electron require('electron')\nconst {app} = electron\n// 判断是否是windos电脑\nif(process.platform === 'win32') {\n    app.setAppUserModelId(pkg.build.appId)\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("在windos下需要注入，mac下好像没问题，没mac，没测试过。")]),n._v(" "),a("p",[n._v("注： 程序需要安装之后才会生效，安装之后跑dev,等环境下通知正常显示。")]),n._v(" "),a("h2",{attrs:{id:"notification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#notification","aria-hidden":"true"}},[n._v("#")]),n._v(" Notification")]),n._v(" "),a("p",[n._v("官方文档demo")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v(" let myNotification = new Notification('标题', {\n body: '通知正文内容'\n})\n\nmyNotification.onclick = () => {\n console.log('通知被点击')\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br")])]),a("p",[n._v("如果不能正常显示，可以尝试")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("\n let myNotification = new window.Notification('标题', {\n  body: '通知正文内容'\n})\n\nmyNotification.onclick = () => {\n  console.log('通知被点击')\n}\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[n._v("配置参数参考文档："),a("code",[n._v("https://electronjs.org/docs/api/notification")]),a("br"),n._v("\n注：一定要注意格式是否正确，标题不能和其他的参数放在一起，不能添加文档中没有的配置参数"),a("br"),n._v("\n否则在win7中可能会有bug，")]),n._v(" "),a("h2",{attrs:{id:"添加点击事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加点击事件","aria-hidden":"true"}},[n._v("#")]),n._v(" 添加点击事件")]),n._v(" "),a("p",[n._v("在pc端应用最小化，点击系统通知唤醒pc端应用。")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("const { ipcRenderer } = require('electron')\n\nipcRenderer.send('mainRestoreWindow')\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br")])]),a("p",[n._v("mainRestoreWindow是定义在main.js中的方法，"),a("br"),n._v("\n我们只需要在点击的时候调用方法即可")]),n._v(" "),a("p",[n._v("mainRestoreWindow函数")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("// 唤起窗口\nlet ipcWindow = () => {\n ipcMain.on('mainRestoreWindow', () => {\n   if (!mainWindow) {\n     createWindow()\n   } else {\n     mainWindow.show()\n     mainWindow.focus()\n   }\n })\n}\n\napp.on('ready', () => {\n // 获取单实例锁\n const gotTheLock = app.requestSingleInstanceLock()\n if (!gotTheLock) {\n   // 如果获取失败，说明已经有实例在运行了，直接退出\n   app.quit()\n }\n ipcWindow()\n})\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br"),a("span",{staticClass:"line-number"},[n._v("20")]),a("br"),a("span",{staticClass:"line-number"},[n._v("21")]),a("br")])]),a("p",[n._v("部分关键代码")]),n._v(" "),a("h2",{attrs:{id:"全局方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局方法","aria-hidden":"true"}},[n._v("#")]),n._v(" 全局方法")]),n._v(" "),a("p",[n._v("在vue中，如果我们想要在js中使用vue中的methods的方法")]),n._v(" "),a("p",[n._v("我们可以在mounted中把方法变成全局方法，但是要慎重使用。项目过大，")]),n._v(" "),a("p",[n._v("容易造成全局污染")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("mounted () {\n     window.openLeftNews = this.showSubstanceLeft\n}\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br")])]),a("h2",{attrs:{id:"html5的notification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#html5的notification","aria-hidden":"true"}},[n._v("#")]),n._v(" html5的notification")]),n._v(" "),a("p",[n._v("html5在目前也是支持系统通知的")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("if (!('Notification' in window)) {\n       return Notification(config)\n   } else if (Notification.permission === 'granted') {\n     // 检查是否同意接受通知\n     new window.Notification(config.title, notificationOption).onclick = config.onClick\n   } else if (Notification.permission !== 'denied') {\n     // 向用户获取权限\n     window.Notification.requestPermission(permission => {\n       if (permission === 'granted') {\n         // 用户同意\n         new window.Notification(config.title, notificationOption).onclick = config.onClick\n       } else {\n         Notification.closeAll()\n       }\n     })\n   }\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br")])])])},[],!1,null,null,null);s.default=i.exports}}]);